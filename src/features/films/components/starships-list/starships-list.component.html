<mat-expansion-panel (opened)="onPanelOpened()">
  <mat-expansion-panel-header>
    <mat-panel-title>
      Starships ({{ starshipUrls.length }})
    </mat-panel-title>
  </mat-expansion-panel-header>

  <div class="panel-content">
    <app-loading-spinner
      *ngIf="(loadingState$ | async)?.isLoading"
      [diameter]="40"
      message="Loading starships..."
    ></app-loading-spinner>

    <app-error-message
      *ngIf="(loadingState$ | async)?.error as errorMessage"
      [message]="errorMessage"
    ></app-error-message>

    <mat-list *ngIf="(starships$ | async) as starships">
      <mat-list-item *ngFor="let starship of starships; trackBy: trackByStarshipUrl" class="starship-item">
        <div class="starship-info">
          <h4 class="starship-name">{{ starship.name }}</h4>
          <div class="starship-details">
            <div class="detail-row">
              <span class="label">Model:</span>
              <span class="value">{{ starship.model }}</span>
            </div>
            <div class="detail-row">
              <span class="label">Manufacturer:</span>
              <span class="value">{{ starship.manufacturer }}</span>
            </div>
            <div class="detail-row">
              <span class="label">Class:</span>
              <span class="value">{{ starship.starship_class }}</span>
            </div>
            <div class="detail-row">
              <span class="label">Cost:</span>
              <span class="value">{{ starship.cost_in_credits }} credits</span>
            </div>
            <div class="detail-row">
              <span class="label">Length:</span>
              <span class="value">{{ starship.length }} m</span>
            </div>
            <div class="detail-row">
              <span class="label">Crew:</span>
              <span class="value">{{ starship.crew }}</span>
            </div>
            <div class="detail-row">
              <span class="label">Passengers:</span>
              <span class="value">{{ starship.passengers }}</span>
            </div>
            <div class="detail-row">
              <span class="label">Hyperdrive Rating:</span>
              <span class="value">{{ starship.hyperdrive_rating }}</span>
            </div>
          </div>
        </div>
      </mat-list-item>
      
      <div class="no-data" *ngIf="starships.length === 0 && !(loadingState$ | async)?.isLoading">
        <p>No starships available for this film.</p>
      </div>
    </mat-list>
  </div>
</mat-expansion-panel>
